diff --git a/sklearn/compose/_column_transformer.py b/sklearn/compose/_column_transformer.py
index 4eddd12b1..c833372ca 100644
--- a/sklearn/compose/_column_transformer.py
+++ b/sklearn/compose/_column_transformer.py
@@ -293,16 +293,23 @@ class ColumnTransformer(TransformerMixin, _BaseComposition):
             Estimator instance.
         """
         super().set_output(transform=transform)
-        transformers = (
-            trans
-            for _, trans, _ in chain(
-                self.transformers, getattr(self, "transformers_", [])
-            )
-            if trans not in {"passthrough", "drop"}
-        )
-        for trans in transformers:
+        seen = set()
+        def _set_if_needed(trans):
+            if trans in {"passthrough", "drop"}:
+                return
+            tid = id(trans)
+            if tid in seen:
+                return
+            seen.add(tid)
             _safe_set_output(trans, transform=transform)
 
+        for _, trans, _ in chain(self.transformers, getattr(self, "transformers_", [])):
+            _set_if_needed(trans)
+
+        # Also set output on remainder estimator if it's an estimator
+        if hasattr(self, "remainder") and self.remainder not in {"passthrough", "drop"}:
+            _set_if_needed(self.remainder)
+
         return self
 
     def get_params(self, deep=True):
